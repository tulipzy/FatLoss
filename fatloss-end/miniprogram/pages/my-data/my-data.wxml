<view class="container">
  <view class="title" style="position: relative; left: 0rpx; top: -6rpx">我的数据</view>
  <view class="loading-tip" wx:if="{{isLoading}}">加载中...</view>

  <!-- 减重进度模块 -->
  <view class="weight-progress-module" wx:else>
    <!-- 淡蓝色渐变背景 -->
    <view class="module-bg" style="height: 675rpx; display: flex; box-sizing: border-box; position: relative; left: -2rpx; top: 14rpx">
      <!-- 新增：目标计划标题 -->
      <view class="module-title">目标计划</view>
      <!-- 坚持天数和目标减重 -->
      <view class="stat-container" style="position: relative; left: -10rpx; top: 175rpx">
        <view class="stat-item">
          <view class="stat-label">已坚持</view>
          <view class="stat-value">{{weightGoal.daysInsisted}}</view>
          <view class="stat-unit">天</view>
        </view>
        <view class="stat-item">
          <view class="stat-label">需减重</view>
          <view class="stat-value">{{weightGoal.remainingLost}}</view>
          <view class="stat-unit">kg</view>
        </view>
      </view>

      <!-- 大圆环 -->
      <view class="circle-container" style="position: relative; left: 1rpx; top: -43rpx">
        <view class="circle-bg"></view>
        <view class="circle-progress" style="transform: rotate(45deg); border-top-color: #1890FF; border-right-color: #1890FF; position: absolute; left: 1rpx; top: 0rpx"></view>
        <view class="circle-content">
          <view class="circle-title">累计减重</view>
          <view class="circle-value">{{weightGoal.totalLost.toFixed(1)}}</view>
          <view class="circle-unit">千克</view>
        </view>
      </view>

      <!-- 体重数据卡片 -->
      <view class="weight-cards">
        <view class="weight-card initial">
          <view class="card-label">初始(kg)</view>
          <view class="card-value">{{weightData.initial}}</view>
        </view>
        <view class="weight-card current">
          <view class="card-label">当前(kg)</view>
          <view class="card-value">{{weightData.current}}</view>
        </view>
        <view class="weight-card target">
          <view class="card-label">目标(kg)</view>
          <view class="card-value">{{weightData.target}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 饮食日记模块 -->
  <view class="diet-diary-module" wx:if="{{!isLoading}}">
    <!-- 淡蓝色渐变背景 -->
    <view class="module-bg diet-diary-bg">
      <!-- 标题区域 -->
      <view class="diary-header">
        <view class="diary-title-container">
          <view class="diary-main-title">饮食日记</view>
          <view class="diary-sub-title">最近三天饮食记录</view>
        </view>
        <view class="view-all">查看全部</view>
      </view>

      <!-- 日期导航 -->
      <view class="date-tabs">
        <view class="date-tab {{currentTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-tab="0">前天</view>
        <view class="date-tab {{currentTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-tab="1">昨天</view>
        <view class="date-tab {{currentTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-tab="2">今天</view>
      </view>

      <!-- 饮食记录列表 -->
      <view class="diet-records">
        <block wx:for="{{dietRecords[currentTab]}}" wx:key="index">
          <view class="diet-record-card">
            <view class="record-time">{{item.time}}</view>
            <view class="record-content">
              <view class="meal-type">{{item.mealType}}</view>
              <view class="food-details">{{item.foodDetails}}</view>
            </view>
            <view class="record-calorie">{{item.calorie}} 千卡</view>
          </view>
        </block>
      </view>

      <!-- 添加饮食记录按钮 -->
      
    </view>
  </view>

  <!-- 运动记录模块 -->
  <view class="exercise-record-module" wx:if="{{!isLoading}}">
    <view class="module-bg exercise-record-bg">
      <!-- 标题区域 -->
      <view class="exercise-header">
        <view class="exercise-title-container">
          <view class="exercise-main-title">运动记录</view>
          <view class="exercise-sub-title">最近三天运动记录</view>
        </view>
        <view class="view-all-exercise">查看全部</view>
      </view>

      <!-- 三列运动类型布局 -->
      <view class="exercise-types-grid">
        <!-- 居家减脂 -->
        <view class="exercise-type-card">
          <view class="exercise-type-header">
            <view class="exercise-type-icon home-workout"></view>
            <view class="exercise-type-name">居家减脂</view>
          </view>
          <view class="exercise-records">
            <block wx:for="{{exerciseRecords.homeWorkout}}" wx:key="index">
              <view class="exercise-record-item {{index !== exerciseRecords.homeWorkout.length - 1 ? 'with-divider' : ''}}">
                <view class="exercise-info">
                  <view class="exercise-name">{{item.name}}</view>
                  <view class="exercise-detail">{{item.detail}}</view>
                </view>
                <view class="exercise-meta">
                  <view class="exercise-calorie">{{item.calorie}}千卡</view>
                  <view class="exercise-date">{{item.date}}</view>
                </view>
              </view>
            </block>
          </view>
        </view>

        <!-- 户外训练 -->
        <view class="exercise-type-card">
          <view class="exercise-type-header">
            <view class="exercise-type-icon outdoor-training"></view>
            <view class="exercise-type-name">户外训练</view>
          </view>
          <view class="exercise-records">
            <block wx:for="{{exerciseRecords.outdoorTraining}}" wx:key="index">
              <view class="exercise-record-item {{index !== exerciseRecords.outdoorTraining.length - 1 ? 'with-divider' : ''}}">
                <view class="exercise-info">
                  <view class="exercise-name">{{item.name}}</view>
                  <view class="exercise-detail">{{item.detail}}</view>
                </view>
                <view class="exercise-meta">
                  <view class="exercise-calorie">{{item.calorie}}千卡</view>
                  <view class="exercise-date">{{item.date}}</view>
                </view>
              </view>
            </block>
          </view>
        </view>

        <!-- 健身房 -->
        <view class="exercise-type-card">
          <view class="exercise-type-header">
            <view class="exercise-type-icon gym-workout"></view>
            <view class="exercise-type-name">健身房</view>
          </view>
          <view class="exercise-records">
            <block wx:for="{{exerciseRecords.gymWorkout}}" wx:key="index">
              <view class="exercise-record-item {{index !== exerciseRecords.gymWorkout.length - 1 ? 'with-divider' : ''}}">
                <view class="exercise-info">
                  <view class="exercise-name">{{item.name}}</view>
                  <view class="exercise-detail">{{item.detail}}</view>
                </view>
                <view class="exercise-meta">
                  <view class="exercise-calorie">{{item.calorie}}千卡</view>
                  <view class="exercise-date">{{item.date}}</view>
                </view>
              </view>
            </block>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>