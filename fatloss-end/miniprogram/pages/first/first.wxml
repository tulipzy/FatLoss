<view class="badges-container">
  <!-- 顶部横幅容器 -->
  <view class="full-top-banner">
    <view class="full-banner-content">
      <text class="full-banner-title">欢迎使用循环减脂助手</text>
      <text class="full-banner-desc">把减脂融入日常，轻松成为习惯</text>
    </view>
  </view>

  <!-- 圆弧分割线 -->
  <view class="arc-divider"></view>

  <!-- 今日推荐区域（修改为动态渲染） -->
  <view class="today-recommend">
    <view class="recommend-title">今日推荐</view>
    
    <!-- 加载状态 -->
    <view wx:if="{{isLoading}}" class="loading-container">
      <view class="loading-spinner"></view>
      <text class="loading-text">加载推荐中...</text>
    </view>

    <!-- 推荐列表（接口数据渲染） -->
    <scroll-view wx:else class="recommend-scroll" scroll-x enable-flex show-scrollbar="{{false}}">
      <view class="feature-card" wx:for="{{recommendations}}" wx:key="id">
        <image class="feature-bg" src="/images/{{item.mealTime === '早餐' ? '早1.jpg' : (item.mealTime === '午餐' ? '午1.jpg' : '晚1.jpg')}}"></image>
        <!-- 餐点标签 -->
        <view class="feature-tag">{{item.mealTime}}</view>
        <!-- 食物推荐内容 -->
        <view class="feature-content">
          <view class="nutrition-item">
            <text class="nutrition-label">碳水：</text>
            <text class="nutrition-value">{{item.carbSource}}</text>
          </view>
          <view class="nutrition-item">
            <text class="nutrition-label">蛋白质：</text>
            <text class="nutrition-value">{{item.proteinSource}}</text>
          </view>
          <view class="nutrition-item">
            <text class="nutrition-label">膳食纤维：</text>
            <text class="nutrition-value">{{item.fiberSource}}</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>




  <!-- 饮食摄入区域（保持不变） -->
  <view class="diet-section">
    <!-- 添加"我的数据"按钮 -->
    <view class="my-data-btn" bindtap="navigateToMyData">
    <text class="my-data-text" style="position: relative; left: -22rpx; top: -22rpx">我的数据></text>
  </view>
    <view class="diet-icon-container">
      <image class="diet-icon" src="/images/小猫.png" style="width: 118rpx; display: block; box-sizing: border-box; position: relative; left: 0rpx; top: 11rpx"></image>
    </view>

    <view class="diet-main-data">
      <view class="diet-item">
        <image class="item-icon" src="/images/饮食摄入.png" style="width: 68rpx; display: block; box-sizing: border-box"></image>
        <text class="item-label">饮食摄入</text>
        <text class="item-value">{{dietCalories}}</text>
        <text class="item-unit">千卡</text>
      </view>

      <view class="remaining-container">
        <svg class="progress-ring" width="240" height="240">
          <circle class="progress-ring-bg" cx="120" cy="120" r="100" fill="none" stroke="#BBDEFB" stroke-width="16" />
          <circle class="progress-ring-circle" cx="120" cy="120" r="100" fill="none" 
                  stroke="{{getProgressColor(dietCalories, calorieGoal)}}" stroke-width="12"
                  stroke-dasharray="628" 
                  stroke-dashoffset="{{calculateRemainingProgress(remainingCalories, calorieGoal)}}"
                  transform="rotate(-90 120 120)" />
        </svg>
        <text class="remaining-label">还可摄入</text>
        <text class="remaining-value">{{remainingCalories}}</text>
        <text class="recommended-intake">推荐摄入{{calorieGoal}}千卡</text>
      </view>

      <view class="diet-item">
        <image class="item-icon" src="/images/运动消耗.png" style="width: 70rpx; display: block; box-sizing: border-box"></image>
        <text class="item-label">运动消耗</text>
        <text class="item-value">{{exerciseCalories}}</text>
        <text class="item-unit">千卡</text>
      </view>
    </view>

    <view class="divider"></view>

    <view class="nutrition-progress" style="width: 674rpx; height: 127rpx; display: block; box-sizing: border-box">
      <view class="nutrition-item" style="height: 68rpx; display: block; box-sizing: border-box">
        <view class="nutrition-header" style="width: 224rpx; height: 37rpx; display: flex; box-sizing: border-box">
          <text class="nutrition-name">碳水</text>
          <text class="nutrition-value" style="position: relative; left: -109rpx; top: 40rpx">{{carbs}}/{{totalCarbs}}克</text>
        </view>
        <view class="progress-bar carbs-bar" style="position: relative; left: 0rpx; top: 49rpx; width: 158rpx; height: 12rpx; display: block; box-sizing: border-box">
          <view class="progress-fill" style="width: 120rpx; position: relative; left: 0rpx; top: 52rpx; height: 35rpx; display: block; box-sizing: border-box"></view>
        </view>
      </view>

      <view class="nutrition-item">
        <view class="nutrition-header">
          <text class="nutrition-name" style="position: relative; left: 216rpx; top: -87rpx">蛋白质</text>
          <text class="nutrition-value" style="position: relative; left: -358rpx; top: -52rpx">{{protein}}/{{totalProtein}}克</text>
        </view>
        <view class="progress-bar protein-bar" style="width: 191rpx; height: 12rpx; display: block; box-sizing: border-box; left: 204rpx; top: -58rpx; position: relative">
          <view class="progress-fill" style="width: 289rpx; height: 2rpx; display: block; box-sizing: border-box; position: relative; left: 37rpx; top: -39rpx"></view>
        </view>
      </view>

      <view class="nutrition-item" style="width: 249rpx; height: 74rpx; display: block; box-sizing: border-box">
        <view class="nutrition-header">
          <text class="nutrition-name" style="position: relative; left: 464rpx; top: -192rpx">脂肪</text>
          <text class="nutrition-value" style="position: relative; left: 295rpx; top: -157rpx">{{fat}}/{{totalFat}}克</text>
        </view>
        <view class="progress-bar fat-bar" style="position: relative; left: 433rpx; top: -154rpx; width: 170rpx; height: 10rpx; display: block; box-sizing: border-box">
          <view class="progress-fill" style="width: 0rpx; height: 39rpx; display: block; box-sizing: border-box"></view>
        </view>
      </view>
    </view>
  </view>
</view>